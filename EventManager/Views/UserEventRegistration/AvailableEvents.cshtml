@model IEnumerable<EventManager.Event>

@{
    ViewBag.Title = "Available Events";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

@section SideBar{
    <nav id="sidebar" data-spy="affix" style="background-color:#151827; max-width:200px;">
        <!-- Sidebar Links -->
        <ul class="list-unstyled components">
            <li class="active" id="AvailableSideBarButton"><a href="#">Available Events</a></li>
            <li id="UserRegistrationSideBarButton">
                <!-- Link with dropdown items -->
                <a href="#registrationsSubMenu" data-toggle="collapse" aria-expanded="false">My Registrations</a>
                <ul class="collapse list-unstyled" id="registrationsSubMenu">
                    <li id="registrationsSideBarAll"><a href="../UserEventRegistration/UserRegistrations" >Show All</a></li>
                    <li id="registrationsSideBarConfirmed"><a href="../UserEventRegistration/UserRegistrations" id="registrationsSideBarConfirmed" ">Confirmed</a></li>
                    <li id="registrationsSideBarPending"><a href="../UserEventRegistration/UserRegistrations" id="registrationsSideBarPending" ">Pending</a></li>
                    <li id="registrationsSideBarStandby"><a href="../UserEventRegistration/UserRegistrations" >Standby</a></li>
                    <li id="registrationsSideBarDeclined"><a href="../UserEventRegistration/UserRegistrations" >Declined</a></li>
                    <li id="registrationsSideBarDeleted"><a href="../UserEventRegistration/UserRegistrations" >Deleted</a></li>

                </ul>
                @*<li><a href="#">Portfolio</a></li>
                    <li><a href="#">Contact</a></li>*@
        </ul>
    </nav>}

<div class="container-fluid" id="AvailableEvents">
    <div class="col-xs-10 col-sm-10">
        <h4>Available Events:</h4>
        <table class="table">
            <tr style="background-color:#333333; color:#fff;">
                <th>
                    Event Name
                </th>
                <th>
                    Start Date/Time
                </th>
                <th>
                    End Date/Time
                </th>
                <th style="text-align:center">
                    Total Hours
                </th>
                <th>
                    Description
                </th>
                <th style="text-align:center">
                    Staffing
                </th>
                <th></th>
            </tr>
            @foreach (var group in Model.GroupBy(date => date.StartTime.ToShortDateString()))
            {
                var d = Convert.ToString(group.Key);
                DateTime dt = Convert.ToDateTime(d);


                <tr>
                    <th colspan="7" style="background-color:#808080; color:#fff; font-weight:normal">@dt.ToLongDateString()</th>
                </tr>

                foreach (var item in group)
                {
                    var total = (item.EndTime - item.StartTime).TotalHours;
                    <tr id="row + @item.EventID" rel="popover">
                        <td style="vertical-align:middle">
                            @Html.DisplayFor(modelItem => item.EventName)
                        </td>
                        <td style="vertical-align:middle">
                            @Html.DisplayFor(modelItem => item.StartTime)
                        </td>
                        <td style="vertical-align:middle">
                            @Html.DisplayFor(modelItem => item.EndTime)
                        </td>
                        <td style="text-align:center; vertical-align:middle">
                            @total
                        </td>
                        <td style="vertical-align:middle">
                            @Html.DisplayFor(modelItem => item.Description)
                        </td>
                        <td style="text-align:center; vertical-align:middle">
                            @Html.DisplayFor(modelItem => item.MaxStaff)
                        </td>
                        <td>
                            <button id="@item.EventID" onClick="RegisterClick(this.id)"
                                    value="@item.EventID,@item.EventName,@item.StartTime,@item.EndTime,@item.Description"
                                    class="btn btn-success">
                                Register
                            </button>
                        </td>
                    </tr>

                }
            }

        </table>
    </div>
</div>

